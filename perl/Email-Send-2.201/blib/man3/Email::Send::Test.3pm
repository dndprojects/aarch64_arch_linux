.\" Automatically generated by Pod::Man 4.10 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "Email::Send::Test 3"
.TH Email::Send::Test 3 "2015-03-05" "perl v5.28.1" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
Email::Send::Test \- Captures emails sent via Email::Send for testing
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 3
\&  # Load as normal
\&  use Email::Send;
\&  use Email::Send::Test;
\&  
\&  # Always clear the email trap before each test to prevent unexpected
\&  # results, and thus spurious test results.
\&  Email::Send::Test\->clear;
\&  
\&  ### BEGIN YOUR CODE TO BE TESTED (example follows)
\&  my $sender = Email::Send\->new({ mailer => \*(AqTest\*(Aq });
\&  $sender\->send( $message );
\&  ### END YOUR CODE TO BE TESTED
\&  
\&  # Check that the number and type (and content) of mails
\&  # matched what you expect.
\&  my @emails = Email::Send::Test\->emails;
\&  is( scalar(@emails), 1, \*(AqSent 1 email\*(Aq );
\&  isa_ok( $emails[0], \*(AqEmail::MIME\*(Aq ); # Email::Simple subclasses pass through
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Email::Send::Test is a driver for use in testing applications that use
Email::Send to send email.
.PP
To be able to use it in testing, you will need some sort of configuration
mechanism to specify the delivery method to be used, or some other way
that in your testing scripts you can convince your code to use \*(L"Test\*(R" as
the mailer, rather than \*(L"Sendmail\*(R" or another real mailer.
.SS "How does it Work"
.IX Subsection "How does it Work"
Email::Send::Test is a trap for emails. When an email is sent, it adds the
emails to an internal array without doing anything at all to them, and
returns success to the caller.
.PP
If your application sends one email, there will be one in the trap. If you
send 20, there will be 20, and so on.
.PP
A typical test will involve doing running some code that \fBshould\fR result
in an email being sent, and then checking in the trap to see if the
code did actually send out the email.
.PP
If you want you can get the emails out the trap and examine them. If you
only care that something got sent you can simply clear the trap and move
on to your next test.
.SS "The Email Trap"
.IX Subsection "The Email Trap"
The email trap is a simple array fills with whatever is sent.
.PP
When you send an email, it is pushed onto the end of the array. You can
access the array directly if you wish, or use the methods provided.
.SH "METHODS"
.IX Header "METHODS"
.ie n .SS "send $message"
.el .SS "send \f(CW$message\fP"
.IX Subsection "send $message"
As for every other Email::Send mailer, \f(CW\*(C`send\*(C'\fR takes the message to be
sent.
.PP
However, in our case there are no arguments of any value to us, and so they
are ignored.
.PP
It is worth nothing that we do \s-1NOTHING\s0 to check or alter the email. For
example, if we are passed \f(CW\*(C`undef\*(C'\fR it ends up as is in the trap. In this
manner, you can see \fBexactly\fR what was sent without any possible tampering
on the part of the testing mailer.
.PP
Of course, this doesn't prevent any tampering by Email::Send itself :)
.PP
Always returns true.
.SS "emails"
.IX Subsection "emails"
The \f(CW\*(C`emails\*(C'\fR method is the preferred and recommended method of getting
access to the email trap.
.PP
In list context, returns the content of the trap array as a list.
.PP
In scalar context, returns the number of items in the trap.
.SS "clear"
.IX Subsection "clear"
The \f(CW\*(C`clear\*(C'\fR method resets the trap, emptying it.
.PP
It is recommended you always clear the trap before each
test to ensure any existing emails are removed and don't
create a spurious test result.
.PP
Always returns true.
.SS "deliveries"
.IX Subsection "deliveries"
This method returns a list of arrayrefs, one for each call to \f(CW\*(C`send\*(C'\fR that has
been made.  Each arrayref is in the form:
.PP
.Vb 1
\&  [ $mailer, $email, \e@rest ]
.Ve
.PP
The first element is the invocant on which \f(CW\*(C`send\*(C'\fR was called.  The second is
the email that was given to \f(CW\*(C`send\*(C'\fR.  The third is the rest of the arguments
given to \f(CW\*(C`send\*(C'\fR.
.SH "SUPPORT"
.IX Header "SUPPORT"
All bugs should be filed via the \s-1CPAN\s0 bug tracker at
.PP
<http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Email\-Send\-Test>
.PP
For other issues, or commercial enhancement or support, contact the author.
.SH "AUTHORS"
.IX Header "AUTHORS"
Current maintainer: Ricardo \s-1SIGNES,\s0 <\fIrjbs@cpan.org\fR>.
.PP
Original author: Adam Kennedy <cpan@ali.as>, <http://ali.as/>
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 2004 \- 2005 Adam Kennedy. All rights reserved.
This program is free software; you can redistribute
it and/or modify it under the same terms as Perl itself.
.PP
The full text of the license can be found in the
\&\s-1LICENSE\s0 file included with this module.
